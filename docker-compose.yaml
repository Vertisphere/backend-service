services:  
  db:
    build:
      context: ./database
      dockerfile: Dockerfile.local
    image: pgdb:latest
    command: ["postgres", "-c", "config_file=/etc/postgresql/postgresql.conf"]
    # Disable so ports only can be accessed by api
    ports:
      - 5432:5432
  api:
    build:
      context: ./middleware
      dockerfile: Dockerfile.local
    image: api:latest
    network_mode: "host"
    command: ["./api"]
    environment:
      - COLOR_LOGS_ENABLED=true
      - ENV=local
      - DB_HOST=localhost
      - DB_USER=main_user
      - DB_PASS=main_pass
      - DB_NAME=main
      - FIREBASE_API_KEY=AIzaSyB4aC40Zw1oUwRgGxqf8EGp2l2XQow-dpU
      - QUICKBOOKS_CLIENT_ID=ABRZXEqL4DpCxHz4OhdiuKg0BXaKIYf4QfVgqLdzC3SngxVNWy
      - QUICKBOOKS_CLIENT_SECRET=I4hPumIZtLlRbvoks9f6Ovzn63sLOdomDBiY5X6S
      - QUICKBOOKS_REDIRECT_URI=https://developer.intuit.com/v2/OAuth2Playground/RedirectUrl
      - QUICKBOOKS_IS_PRODUCTION=false
      - JWE_KEY=KJZGB66mU0xTAFwOk4edH1GD/NxQxBfwxVkdtTf0OqY=
    ports:
      - 8080:8080

# networks:
#   my-network:
#     driver: bridge